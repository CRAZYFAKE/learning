[TOC]



# HTTPS 传输的整个过程

先付一张图

![Https连接建立的过程](https://raw.githubusercontent.com/CRAZYFAKE/learning/master/_picture/https.png)





1.客户端发送连接请求

2.服务端配置证书

一般是自己生成，或者向Ca机构申请

3.传送证书

服务端把证书传给客户端，一般包括证书的颁发机构，过期时间等等。

4.客户端解析证书

由客户端的TLS来完成的，首先会验证公钥是否有效，比如颁发机构，过期时间等等，如果发现异常，则会弹出一个警告框，提示证书存在问题。如果证书没有问题，那么就生成一个随即值。然后用证书对该随机值进行加密。就好像上面说的，把随机值用锁头锁起来，这样除非有钥匙，不然看不到被锁住的内容。

5.传送加密信息

传送证书公钥加密后的客户端的随机值，目的是让服务端得到这个值，（对称加密密钥）

6.服务端解密信息

服务端用自己的私钥解密传送结果，得到客户端传过来的加密密钥，然后把内容通过该值进行对称加密。

7.传输加密后的信息

这部分信息是服务段用私钥加密后的信息，可以在客户端被还原

8.客户端解密信息

客户端用之前生成的私钥解密服务段传过来的信息，于是获取了解密后的内容。整个过程第三方即使监听到了数据，也束手无策。









