

[TOC]

# 前言

![前言](../_picture/编写可读代码的艺术.jpeg)

## 一.代码应当易于理解

* 可读性基本原则

  >  代码的写法应当使别人理解它所需的最小时间

* 尽量减少代码行数，但也不是越少越好，仍然是基于理解基础

# 第一部分 表面层次的改进

## 二.把信息体现到名字中

> **关键思想**
>
> 把信息装入名字中

1. 选择专业的词

   找到更有代表性的词、更有体现力的词

   | 单词    | 同义词                                      |
   | ----- | ---------------------------------------- |
   | send  | deliver、dispatch、announce、distribute、route |
   | find  | search、extract、locate、recover            |
   | start | launch、create、begin、open                 |
   | make  | create、set up、build、generate、compose、add、new |

2. 避免像tmp和retval这样泛泛的词

   > 建议
   >
   > retval名字没有包含更多的信息，用一个描述该变量的值的名字来代替它
   >
   > tmp这个名字只应用于短期存在且临时性为其主要存在因素的变量

3. 使用具体的名字来更细致地描述事物

4. 给变量名带上更重要的细节，如给值为毫秒的变量后面加上_ms

5. 为作用域大的名字采用更长的名字

6. 有目的地使用大小写、下划线等

## 三.不要误解的名字

> **关键思想**
>
> 更多的问自己几遍：“这个名字会被别人理解成其他的含义吗？”仔细审视这个名字

1. 推荐使用min和max来表示（包含）极限

   > **建议**
   >
   > 在要限制的东西前加上`min_`或者`max_`

2. 用first和last表示包含的范围

3. 用begin和end来表示包含/排除范围

4. 为布尔值命名时，使用is 和 has这样的词来明确表示它是个布尔值


## 四.审美

> **三条原则**
>
> 1. 使用一致的格局，让读者很快就习惯这种风格
> 2. 让相似的代码看上去相似
> 3. 把相关的代码行分组，形成代码块

* 如果多个代码块做相似的事情，尝试让它们有相同的影子
* 把代码按照“列”对齐可以让代码更容易浏览
* 如果在一段代码中提到A、B和C，那么不要在另一段中说B、C和A。选择一个有意义的顺序，并始终用这样的顺序
* 用空行来把大块代码分成逻辑上的“段落”

## 五.怎么写注释

> 关键思想：注释的目的是尽量帮助读者了解得和作者一样多

### 什么不需要注释

> 关键思想：不要为那些从代码本身就能快速推断的事实写注释

1. 不要为了注释而注释
2. 不要给不好的名字加注释—应该把名字改好（一个好的名字比一个好的注释更重要）

  **好代码 > 坏代码 + 坏注释**

### 记录你的思想

1. 加入“导演评论”

2. 为代码中的瑕疵写注释，如：

   ```
   // TODO:采用更快的算法
   // TODO:处理除JPEG以外的图像格式
   ```

   几种注释标识：

   | 标识     | 意义                   |
   | ------ | -------------------- |
   | TODO:  | 我还没处理的事情             |
   | FIXME: | 已知的无法运行的代码           |
   | HACK:  | 对一个问题不得不采用的比较粗糙的解决方案 |
   | XXX:   | 危险，这里有更重要的问题         |

3. 给常量加注释

### 站在读者的角度

> 换个说法：想象你的代码对于外人来讲看起来是什么样子的

1. 意料之中的提问

2. 功不可能存在的缺陷

   需要“未雨绸缪”，预料到人们使用你的代码可能会遇到什么问题

3. “ 全局观 ”注释

   ```
   //这个文件包含一些辅助函数，为我们的文件系统提供了更便利的接口
   //他处理了文件权限及其他基本的细节
   ```

4. 总结性注释

   注释其后的底层代码

5. 用注释来总结代码快，使读者不至于迷失在细节中

## 六.写出言简意赅的注释

> **关键思想**
>
> 注释应该有很高的信息/空间率

1. 让注释保持紧凑

2. 避免使用不明确的代词

   避免使用像“ it ”和“ this ”这样可能代表很多事物的代词

3. 润色粗糙的句子

4. 准确地描述函数的行为

5. 用输入/输出例子来说明特别情况

6. 声明代码的意图

   声明代码的高层次意图，而非明显的细节

7. "具名函数参数"的注释

   用嵌入的注释来解释难理解的函数参数

8. 采用信息含量高的词

# 第二部分 简化循环和逻辑

## 七.把控制流变得易读

> **关键思想**
>
> 把条件、循环以及其他对控制流的改变做得越自然越好。运用一种方式使读者不用停下来重读你的代码

1. 条件语句中参数的顺序

   避免使用` if(obj === NULL) `，而是使用` if(NULL === obj) `

2. if/else 语句块的顺序

   - 首先处理正逻辑而非负逻辑
   - 先处理掉简单的情况
   - 先处理有趣的或者是可以的情况

3. 三目运算符

   > 相对于追求最小化代码行数，一个更好的度量方法是最小化人们理解它所需的时间
   >
   > 默认情况下都使用`if/else`，三目运算符 `?: `只有在最简单的情况下使用

4. 避免do/while循环

5. 从函数提前返回

6. 避免goto

7. 最小化嵌套


## 八.拆分超长的表达式

> **关键思想**
>
> 把超长的表达式拆分成更容易理解的小块

1. 用做解释的变量

   拆分表达式最简单的方式就是引入一个额外的变量，这个额外的变量有时叫做 ‘ 解释变量 ’

2. 不要滥用布尔操作

   > **关键思想**
   >
   > 要小心“智能”的小代码块 —— 往往在以后会让人读起来感到困惑

3. 使用德摩根定理来操作逻辑表达式

   ```
   1) not (a or b or c) <=> (not a) and (not b) and (not c) 
   2) not (a and b and c) <=> (not a) or (not b) or (not c)
   ```

   举个栗子：

   ```javascript
   if(!(file_exists && !is_protected)){
      throw new Error("Sorry, could read file.")
   }
   ```

   可以改成：

   ```javascript
   if(!file_exists || is_protected){
      throw new Error("Sorry, could read file.")
   }
   ```

## 九.变量与可读性

> 三个问题：
>
> 1. 变量越多，就越难全部跟踪它们的去向
> 2. 变量的作用域越大，机会需要跟踪它的动向越久
> 3. 变量改变的越频繁，就越难以跟踪它的当前值

### 减少变量

1. 减少没有价值的临时变量
2. 减少中间结果
3. 减少控制流变量（你希望你的同事随时都觉得实在面试吗？）

### 缩小变量的作用域

> **关键思想**
>
> 让你的变量对尽量少的代码可见

### 只写一次的变量更好

只设置一次值得变量（或者const、final、常量）使得代码更容易理解

# 第三部分 重新组织代码

- 抽取出那些与程序主要目的不相关的子问题
- 重新组织代码使它一次只做一件事
- 先用自然语言描述代码，然后用这个描述来帮助你找到更整洁的解决方案


## 十.抽取不相关的子问题

> **建议**
>
> 积极地发现并抽取出不相关的子逻辑

* 抽象出纯工具代码
* 创建大量通用代码
* 项目专有代码
* 不可过度拆分

## 十一.一次只做一件事

> **关键思想**
>
> 应该把代码组织得一次只做一件事情

* 抽象出单独的函数或类
* 其他的可以简单的成为一个函数中的逻辑“段落”

## 十二.把想法变成代码





